<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />

<!-- Prevent browser caching so Pages shows latest content -->
<meta http-equiv="cache-control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="pragma" content="no-cache" />
<meta http-equiv="expires" content="0" />

<title>Pari ðŸ’— â€” A Small Sorry from Chazzi ðŸ˜‹</title>

<style>
  /* Simple resilient styles, no external fonts */
  :root{
    --sky1:#dff6ff; --sky2:#bde7ff; --accent:#2ea8f6; --text:#033047;
    --muted:#4b6b7a; --radius:18px; --heart:#ff6fa6;
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  }
  html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--sky1),var(--sky2));color:var(--text)}
  .wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}
  .card{width:min(560px,96vw);background:white;padding:22px;border-radius:var(--radius);box-shadow:0 20px 50px rgba(0,0,0,0.1);position:relative;overflow:visible}
  .header{display:flex;gap:12px;align-items:center}
  .avatar{width:70px;height:70px;border-radius:14px;background:linear-gradient(135deg,#aee9ff,#66d0ff);display:grid;place-items:center;color:#013240;font-size:28px;box-shadow:0 8px 20px rgba(46,168,246,0.12)}
  h1{margin:0;font-size:20px}
  .lead{margin:6px 0 0;color:var(--muted)}
  .msg{margin-top:16px;line-height:1.5;font-size:16px; transform-origin:top center; animation: swing 3200ms ease-in-out infinite}
  @keyframes swing{0%{transform:rotate(-1.2deg)}25%{transform:rotate(.9deg)}50%{transform:rotate(-.6deg)}75%{transform:rotate(.8deg)}100%{transform:rotate(-1.2deg)}}

  .actions{margin-top:18px;display:flex;gap:10px;align-items:center}
  button{padding:10px 14px;border-radius:12px;border:0;font-size:14px;font-weight:700;cursor:pointer}
  .primary{background:linear-gradient(90deg,var(--accent),#68c9ff);color:white;box-shadow:0 8px 30px rgba(46,168,246,0.12)}
  .ghost{background:transparent;color:var(--muted);border:1px solid rgba(2,28,45,0.05)}
  .reply{display:none;flex-direction:column;gap:8px;margin-top:12px}
  textarea{width:100%;min-height:90px;border-radius:10px;padding:12px;border:1px solid rgba(0,0,0,0.08);font-size:14px;resize:vertical}
  .note{font-size:13px;color:var(--muted);margin-top:8px}

  /* Fullscreen "I'm Sorry" */
  .overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.45);visibility:hidden;opacity:0;transition:all .35s ease;z-index:999}
  .overlay.show{visibility:visible;opacity:1}
  .panel{background:linear-gradient(180deg,#fff,#e8f7ff);padding:28px;border-radius:16px;box-shadow:0 30px 80px rgba(0,0,0,.28);text-align:center;max-width:92%;transform-origin:center}
  .bigtext{font-weight:900;font-size:40px;color:#003f66;white-space:nowrap;overflow:hidden}
  .marquee{display:inline-block;padding-left:100%;animation:slide 6s linear infinite;white-space:nowrap}
  @keyframes slide{0%{transform:translateX(0)}50%{transform:translateX(-45%)}100%{transform:translateX(0)}}

  /* falling hearts */
  .hearts{pointer-events:none;position:fixed;inset:0;overflow:hidden;z-index:1000}
  .heart{position:absolute;font-size:22px;will-change:transform,opacity;animation:fall linear forwards}
  @keyframes fall{0%{transform:translateY(-30vh) translateX(0) scale(.8);opacity:1}100%{transform:translateY(110vh) translateX(40px) scale(1.05);opacity:.02}}

  /* confetti canvas */
  #confetti{position:fixed;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:1001}

  .controls { margin-top:12px; display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
  .small { font-size:12px; color:var(--muted); }
  .force { background:#fff; border:1px solid rgba(0,0,0,0.06); color:var(--text); box-shadow:none; padding:8px 10px; border-radius:10px; cursor:pointer; font-weight:600; }

  @media(max-width:420px){ .bigtext{font-size:26px} .avatar{width:56px;height:56px} }
</style>
</head>
<body>

<!-- Confetti + hearts containers -->
<canvas id="confetti"></canvas>
<div class="hearts" id="hearts"></div>

<div class="wrap">
  <div class="card" role="main" aria-labelledby="title">
    <div class="header">
      <div class="avatar" aria-hidden="true">ðŸ’—</div>
      <div>
        <h1 id="title">For Pari ðŸ’—</h1>
        <p class="lead">A little message from Chazzi ðŸ˜‹</p>
      </div>
    </div>

    <div class="msg" id="msg">
      <strong>Pari â€”</strong> I'm really sorry pariiiiðŸ¥° I hope this makes you smile.
      <div class="note">This is from my heart â€” read it, take your time, and if you want, reply below. ðŸ’™</div>
    </div>

    <div class="actions">
      <button class="primary" id="openBtn">Read the full "I'm Sorry"</button>
      <button class="ghost" id="replyBtn">Let Pari reply</button>
    </div>

    <div class="reply" id="replyBlock">
      <label class="small" for="reply">Write your reply (optional):</label>
      <textarea id="reply" placeholder="Hey Chazzi..."></textarea>
      <div style="display:flex;gap:8px;margin-top:8px">
        <button class="primary" id="sendReply">Send Reply</button>
        <button class="ghost" id="cancelReply">Cancel</button>
        <button class="force" id="forceReload">Force reload (hard)</button>
      </div>
    </div>

    <div class="controls">
      <div class="small">Version: <strong id="version">v1</strong></div>
    </div>
  </div>
</div>

<!-- overlay -->
<div class="overlay" id="overlay" aria-hidden="true">
  <div class="panel" role="dialog" aria-modal="true">
    <div style="font-size:16px;font-weight:700;color:#00415a">Chazzi says...</div>
    <div style="height:18px"></div>
    <div class="bigtext"><span class="marquee" id="marquee">I'M SO SORRY PARIIII ðŸ¥° â€” PLEASE FORGIVE ME â€” I LOVE YOU â€”</span></div>
    <div style="margin-top:18px;display:flex;gap:10px;justify-content:center">
      <button class="primary" id="closeBtn">Close</button>
      <button class="ghost" id="replayBtn">Replay</button>
    </div>
  </div>
</div>

<script>
/* CONFIG: set to false if you don't want the I'm Sorry panel to auto-open */
const AUTO_OPEN = true;

/* small version label so you can bump it when you update code */
document.getElementById('version').textContent = 'v1.2';

/* Elements */
const overlay = document.getElementById('overlay');
const openBtn = document.getElementById('openBtn');
const closeBtn = document.getElementById('closeBtn');
const replayBtn = document.getElementById('replayBtn');
const replyBtn = document.getElementById('replyBtn');
const replyBlock = document.getElementById('replyBlock');
const forceReload = document.getElementById('forceReload');
const sendReply = document.getElementById('sendReply');
const cancelReply = document.getElementById('cancelReply');
const reply = document.getElementById('reply');
const marquee = document.getElementById('marquee');

/* show overlay and effects */
function showOverlay(){
  overlay.classList.add('show');
  overlay.setAttribute('aria-hidden','false');
  startHearts(18);
  fireConfetti(140);
}

/* hide overlay */
function hideOverlay(){
  overlay.classList.remove('show');
  overlay.setAttribute('aria-hidden','true');
}

/* handlers */
openBtn.addEventListener('click', showOverlay);
closeBtn.addEventListener('click', hideOverlay);
replayBtn.addEventListener('click', ()=>{
  // restart marquee
  marquee.style.animation = 'none';
  void marquee.offsetWidth;
  marquee.style.animation = null;
  startHearts(12);
  fireConfetti(100);
});

replyBtn.addEventListener('click', ()=> { replyBlock.style.display = 'flex'; reply.focus(); });
cancelReply.addEventListener('click', ()=> { replyBlock.style.display = 'none'; reply.value=''; });

sendReply.addEventListener('click', ()=>{
  const txt = reply.value.trim();
  if(!txt){
    alert("Type a short reply or press Cancel.");
    return;
  }
  // show small confirmation (no server)
  alert("Reply saved locally. Thank you!");
  reply.value = '';
  replyBlock.style.display = 'none';
});

/* Force hard reload: add cache-busting param */
forceReload.addEventListener('click', ()=>{
  const url = location.href.split('?')[0] + '?cb=' + Date.now();
  location.replace(url);
});

/* ===== confetti (canvas) ===== */
const confCanvas = document.getElementById('confetti');
const ctx = confCanvas.getContext && confCanvas.getContext('2d');
let W = innerWidth, H = innerHeight;
if(ctx){ confCanvas.width = W; confCanvas.height = H; window.addEventListener('resize', ()=>{ W = confCanvas.width = innerWidth; H = confCanvas.height = innerHeight; }); }
let confetti = [];
function rand(min,max){ return Math.random()*(max-min)+min; }
function fireConfetti(count=80){
  if(!ctx) return;
  confetti = [];
  for(let i=0;i<count;i++){
    confetti.push({ x: rand(0,W), y: rand(-H,0), w: rand(6,12), h: rand(8,16), vx: rand(-0.6,0.6), vy: rand(2,6), rot: rand(0,360), rotSpeed: rand(-6,6), color: `hsl(${Math.floor(rand(330,360))} ${Math.floor(rand(60,90))}% ${Math.floor(rand(45,65))}%)` });
  }
  requestAnimationFrame(confLoop);
}
function confLoop(){
  ctx.clearRect(0,0,W,H);
  for(let p of confetti){
    p.x += p.vx; p.y += p.vy; p.vy += 0.05; p.rot += p.rotSpeed;
    ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.rot*Math.PI/180); ctx.fillStyle = p.color; ctx.fillRect(-p.w/2,-p.h/2,p.w,p.h); ctx.restore();
  }
  confetti = confetti.filter(p=>p.y < H+50);
  if(confetti.length) requestAnimationFrame(confLoop); else if(ctx) ctx.clearRect(0,0,W,H);
}

/* ===== falling hearts ===== */
const hearts = document.getElementById('hearts');
function makeHeart(size, left, duration, hue){
  const el = document.createElement('div');
  el.className = 'heart';
  el.style.left = left + 'px';
  el.style.fontSize = size + 'px';
  el.style.color = `hsl(${hue} 90% 60%)`;
  el.style.animationDuration = duration + 's';
  el.style.top = '-' + (size + 20) + 'px';
  el.innerText = 'ðŸ’—';
  hearts.appendChild(el);
  setTimeout(()=> { if(el && el.parentNode) el.parentNode.removeChild(el); }, duration*1000 + 500);
}
function startHearts(n=12){
  const Ww = window.innerWidth;
  for(let i=0;i<n;i++){
    const left = Math.floor(Math.random()*Ww);
    const size = Math.floor(rand(18,46));
    const duration = rand(3.2,6.0);
    const hue = Math.floor(rand(330,360));
    setTimeout(()=> makeHeart(size, left, duration, hue), i*80);
  }
}

/* Accessibility: Esc closes overlay and hides reply area */
document.addEventListener('keydown', (e)=> {
  if(e.key === 'Escape'){
    hideOverlay();
    replyBlock.style.display = 'none';
  }
});

/* Auto-open on first load (optional) */
if(AUTO_OPEN){
  // open after short delay so page finishes painting
  window.addEventListener('load', ()=> setTimeout(showOverlay, 800));
}

/* Safety: make sure this page can't get stuck visually â€” retry logic */
(function ensureFresh(){
  // If this page loads but overlay never appears due to something blocking scripts,
  // show a visible manual button to force overlay.
  const fallback = document.createElement('button');
  fallback.textContent = "Show 'I'm Sorry'";
  fallback.className = 'force';
  fallback.style.position = 'fixed';
  fallback.style.right = '14px';
  fallback.style.bottom = '14px';
  fallback.style.zIndex = 2000;
  fallback.onclick = showOverlay;
  document.body.appendChild(fallback);
})();

</script>
</body>
</html>
